<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Causal Inference</title>
    <meta charset="utf-8" />
    <meta name="author" content="CWAN| 王　超辰" />
    <script src="libs/header-attrs-2.3/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Causal Inference
### CWAN| 王　超辰
### 2020-07-31 (Fri) <br> <span class="citation">@HOME</span> 15:00-16:00

---



class: middle, inverse, center

# Chapter 1, Definition


---
class: middle

## Outline

.large[
- Purpose
1. Individual causal effect
2. Average causal effects
3. Measures of causal effect
4. Random variability
5. Causation versus association
]

---
class: middle

## Purpose

.full-width[.content-box-red[.bold[
To introduce the **mathematical notation** &lt;br&gt; that could formalize the causal intuition.
]]]

---
class: middle

## Individual causal effect (1)

.full-width[.content-box-red[.bold[
We compare (mentally) the outcome &lt;br&gt; **when an action `\(A\)` is taken** &lt;br&gt; with the outcome &lt;br&gt; **when the action `\(A\)` is withheld.**
]]]

.med[
- Zeus is waiting for a heart transplant. 
  - He dies five days later after receiving a new heart
  - He survives five days later if he did not had transplant
  - We say **the heart transplant caused** Zeus's death.
]

---
class: middle

## Individual causal effect (2)

.full-width[.content-box-red[.bold[
We compare (mentally) the outcome &lt;br&gt; **when an action `\(A\)` is taken** &lt;br&gt; with the outcome &lt;br&gt; **when the action `\(A\)` is withheld.**
]]]

.med[
- Hera is also waiting for a heart transplant. 
  - She survives five days later after heart transplant
  - She also survives five days later if she did not had transplant
  - We say **the heart transplant has no causal effect**.
]

---
class: middle
## Individual causal effect (3)

.full-width[.content-box-red[.bold[
We compare (mentally) the outcome 
&lt;br&gt; **when an action `\(A\)` is taken** 
&lt;br&gt; with the outcome 
&lt;br&gt; **when the action `\(A\)` is withheld.** 
&lt;br&gt;  `\(A\)` could be an intervention, an exposure, 
&lt;br&gt;  or a treatment.
]]]

---
class: middle
## Individual causal effect (4)

- Consider a dichotomous treatment variable `\(A\)`
    - 1 = treated
    - 0 = untreated
- And a dichotomous outcome variable `\(Y\)`
    - 1 = death
    - 0 = survival
- We define: 
    - `\(Y^{a = 1}\)`: the outcome that would be observed under treatment `\(a = 1\)`
    - `\(Y^{a = 0}\)`: `\(Y\)` under treatment `\(a = 0\)`
 
---
class: middle
## Individual causal effect (5)

.pull-left[
- Zeus has: 
    - `\(Y^{a = 1} = 1\)`
    - `\(Y^{a = 0} = 0\)`
- Hera has: 
    - `\(Y^{a = 1} = 0\)`
    - `\(Y^{a = 0} = 0\)`
]

.pull-right[
- `\(Y^{a = 1} \neq Y^{a = 0}\)` &lt;br&gt; then there is a &lt;br&gt; **causal effect**
- `\(Y^{a = 1}, Y^{a = 0}\)` are &lt;br&gt; **potential or counterfactual outcomes**
]

???
- "Potential" because either of these two outcomes can be potentially observed
- "Counterfactual" because these outcomes represent situations that may not actually occur


---
class: middle
## Individual causal effect (6)


.full-width[.content-box-red[.bold[
**Consistency:**
&lt;br&gt; For each individual, one of the potential 
&lt;br&gt; outcomes will actually occur. 
&lt;br&gt; For example, Zeus was actually treated 
&lt;br&gt; `\((A = 1)\)`, his counterfactual outcome 
&lt;br&gt; `\(Y^{a = 1} = 1\)` is equal to what was observed. 
&lt;br&gt; `\(Y = Y^{a = 1} = 1\)` is called **consistency**.
]]]


---
class: middle
## Average causal effect (1)

.full-width[.content-box-red[.bold[
We need three pieces of information: 
- an outcome of interest
- the action `\(a = 1, a= 0\)` to be compared
- the counterfactual outcomes `\(Y^{a = 1}, Y^{a = 0}\)`
]]]

.med[Normally it is not possible to identify individual causal effects. We turn to an **aggregated causal effect**.]


---
class: middle
## Average causal effect (2)

.pull-left[
&lt;style type="text/css"&gt;
.tg  {border-collapse:collapse;border-color:#bbb;border-spacing:0;}
.tg td{background-color:#E0FFEB;border-color:#bbb;border-style:solid;border-width:0px;color:#594F4F;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{background-color:#9DE0AD;border-color:#bbb;border-style:solid;border-width:0px;color:#493F3F;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-1wig{font-weight:bold;text-align:left;vertical-align:top}
.tg .tg-cyim{font-size:20px;text-align:left;vertical-align:top}
.tg .tg-bhpp{font-size:20px;font-weight:bold;text-align:left;vertical-align:top}
.tg .tg-0lax{text-align:left;vertical-align:top}
&lt;/style&gt;
&lt;table class="tg"&gt;
&lt;thead&gt;
  &lt;tr&gt;
    &lt;th class="tg-0lax"&gt;&lt;/th&gt;
    &lt;th class="tg-1wig"&gt;\[\mathbf{Y^{a = 0}}\] &lt;/th&gt;
    &lt;th class="tg-1wig"&gt; \[\mathbf{Y^{a = 1}}\] &lt;/th&gt;
    &lt;th class="tg-0lax"&gt;&lt;/th&gt;
    &lt;th class="tg-1wig"&gt; \[\mathbf{Y^{a = 0}}\] &lt;/th&gt;
    &lt;th class="tg-1wig"&gt; \[\mathbf{Y^{a = 1}}\] &lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Rheia&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Leto&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Kronos&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Ares&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Demeter&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Athena&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Hades&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Hephaestus&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Hestia&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Aphrodite&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Poseidon&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Cyclope&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Hera&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Persephone&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Zeus&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Hermes&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Artemis&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Hebe&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-bhpp"&gt;Apollo&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
    &lt;td class="tg-bhpp"&gt;Dionysus&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;1&lt;/td&gt;
    &lt;td class="tg-cyim"&gt;0&lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.pull-right[.small[
- 10 out of 20 would have died if they had received the treatment
`\(\text{Pr}[\mathbf{Y}^{a = 1} = 1] = 10/20 \\ = 0.5\)`

- 10 out of 20 would have died if they if they had not received the treatment
`\(\text{Pr}[\mathbf{Y}^{a = 0} = 1] = 10/20 \\ = 0.5\)`
]]

---
class: middle
## Average causal effect (3)


.full-width[.content-box-red[.bold[
An **average causal effect** of treatment `\(A\)` on outcome `\(Y\)` is present if 

$$
\text{Pr}[\mathbf{Y}^{a = 1} = 1] \neq \text{Pr}[\mathbf{Y}^{a = 0} = 1]
$$
]]]

In the previous table, because `\(\text{Pr}[\mathbf{Y}^{a = 1} = 1] = \text{Pr}[\mathbf{Y}^{a = 0} = 1] = 0.5\)`, 
&lt;br&gt; we say that the average causal effect is null, or the
&lt;br&gt; **null hypothesis of no average causal effect is true**.


---
class: middle

## Measures of causal effect (1)

.full-width[.content-box-red[.bold[
These are equivalent ways of representing the causal null: 

- **Risk difference**: `\(\text{Pr}[\mathbf{Y}^{a = 1} = 1] - \text{Pr}[\mathbf{Y}^{a = 0} = 1] = 0\)`
- **Risk ratio**: 
`\(\frac{\text{Pr}[\mathbf{Y}^{a = 1} = 1]}{\text{Pr}[\mathbf{Y}^{a = 0} = 1]} = 1\)`
- **Odds ratio**: 
`\(\frac{\text{Pr}[\mathbf{Y}^{a = 1} = 1] / \text{Pr}[\mathbf{Y}^{a = 1} = 0]}{\text{Pr}[\mathbf{Y}^{a = 0} = 1]/\text{Pr}[\mathbf{Y}^{a = 0} = 0]} = 1\)`
]]]


---
class: middle

## Measures of causal effect (2)

.med[
- Causal risk difference, risk ratio, and odds ratio
    - quantify the strength of the same causal effect on **different scales**
    - also called **causal effects**
- Consider use different measures for different purposes:
    - 3 in a million vs. 1 in a million deaths
        - causal risk difference: 0.000002
        &lt;br&gt; the absolute number of cases of disease attributable to the treatment.
        - causal risk ratio: 3
        &lt;br&gt; how many times treatment relative to no treatment increases the risk
]


---
class: middle

## Measures of causal effect (3) - **Number needed to treat, NNT**

.full-width[.content-box-red[.bold[
.small[
Consider 100 million patients in which 
&lt;br&gt; 20 million would die within 5 years if treated `\((a = 1)\)`
&lt;br&gt; 30 million would die within 5 years if untreated `\((a = 0)\)`
&lt;br&gt; the causal risk difference is 
&lt;br&gt; `\(\text{Pr}[\mathbf{Y}^{a = 1} = 1] - \text{Pr}[\mathbf{Y}^{a = 0} = 1] = 0.2 - 0.3 = -0.1\)`
- If one treats the 100 million patients, there will be 10 million fewer deaths 
- One needs to treat 100 million patients to save 10 million lives, i.e. **treat 10 patients to save 1 life (= NNT)**
- NNT is equal to the inverse of the causal risk difference
]

]]]


---
class: middle

## Random variability

.med[
- The populations of interest are typically much larger. In practice, we only collect information on a sample of the population of interest.

- The "hat" over `\(\text{Pr}\)` indicates that the sample proportion `\(\widehat{\text{Pr}}[\mathbf{Y}^{a} = 1]\)` is an **estimator** of the corresponding population quantity `\(\text{Pr}[\mathbf{Y}^{a} = 1]\)`. 

- **The larger** the number of individuals in the sample, **the smaller** the difference between `\(\widehat{\text{Pr}}[\mathbf{Y}^{a} = 1]\)` and `\(\text{Pr}[\mathbf{Y}^{a} = 1]\)` is expected to be.

- The error due to sampling variability is random.
]


---
class: middle

## Causation versus association (1)

.pull-left[
.med[In the real world, we only can observe one of these (potential) outcomes because the individual is either treated or untreated.
- 7 died in 13 who were treated `\((A=1)\)` 
`\(\text{Pr}[Y = 1|A = 1] \\ = 7/13\)`
- `\(\text{Pr}[Y = 1|A = a]\)` conditional probability
]
]


.pull-right[
&lt;style type="text/css"&gt;
.tg  {border-collapse:collapse;border-color:#bbb;border-spacing:0;}
.tg td{background-color:#E0FFEB;border-color:#bbb;border-style:solid;border-width:0px;color:#594F4F;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{background-color:#9DE0AD;border-color:#bbb;border-style:solid;border-width:0px;color:#493F3F;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-1wig{font-weight:bold;text-align:left;vertical-align:top}
.tg .tg-0lax{text-align:left;vertical-align:top}
&lt;/style&gt;
&lt;table class="tg"&gt;
&lt;thead&gt;
  &lt;tr&gt;
    &lt;th class="tg-0lax"&gt;&lt;/th&gt;
    &lt;th class="tg-1wig"&gt;A&lt;/th&gt;
    &lt;th class="tg-1wig"&gt;Y&lt;/th&gt;
    &lt;th class="tg-0lax"&gt;&lt;/th&gt;
    &lt;th class="tg-1wig"&gt;A&lt;/th&gt;
    &lt;th class="tg-1wig"&gt;Y&lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Rheia&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Leto&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Kronos&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Ares&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Demeter&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Athena&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Hades&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Hephaestus&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Hestia&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Aphrodite&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Poseidon&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Cyclope&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Hera&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Persephone&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Zeus&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Hermes&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Artemis&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Hebe&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-1wig"&gt;Apollo&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-1wig"&gt;Dionysus&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;1&lt;/td&gt;
    &lt;td class="tg-0lax"&gt;0&lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]


---
class: middle

## Causation versus association (2)


- When `\(\text{Pr}[Y = 1|A = 1] = \text{Pr}[Y = 1|A = 0]\)` &lt;br&gt; we say that treatment `\(A\)` and outcome `\(Y\)` are **independent**: `\(A \perp \!\!\! \perp Y\)` 

- We say that treatment `\(A\)` is not associated with `\(Y\)` or, `\(A\)` does not predict `\(Y\)`.

- We also say that `\(A\)` is associated with `\(Y\)` if `\(\text{Pr}[Y = 1|A = 1] \neq \text{Pr}[Y = 1|A = 0]\)`

---
class: middle

## Association measures

Similarly, associational risk differences, risk ratio, and odds ratio can be defined as: 

.full-width[.content-box-red[.bold[
- **Risk difference**: `\(\text{Pr}[Y =1 | A= 1] - \text{Pr}[Y = 1| A= 0]\)` 
- **Risk ratio**: `\(\frac{\text{Pr}[Y =1 | A= 1]}{\text{Pr}[Y = 1| A= 0]}\)`
- **Odds ratio**: `\(\frac{\text{Pr}[Y =1 | A= 1] / \text{Pr}[Y = 0 | A= 1]}{\text{Pr}[Y = 1| A= 0] / \text{Pr}[Y = 0| A= 0]}\)`
]]]


---
class: middle

## Causation versus association (3)

In our sample of 20 individuals, we found 

1. no causal effect, because &lt;br&gt; `\(\text{Pr}[\mathbf{Y}^{a = 1} = 1] - \text{Pr}[\mathbf{Y}^{a = 0} = 1] = 0.5 - 0.5 = 0\)`
2. an association because &lt;br&gt; `\(\text{Pr}[Y =1 | A= 1] - \text{Pr}[Y = 1| A= 0] \\ =7/13 - 3/7 = 0.11\)` 


---
class: top, center
background-image: url("./fig/causalassociation.png")
background-position: 50% 50%
background-size: contain


---
class: middle

## Causation versus association (4)

1. **Causation**:a contrast between the whole white diamond (**all individuals treated**) and the whole grey diamond (**all individuals untreated**). &lt;br&gt; .blue[*"What would be the risk if everybody had been treated/untreated?"*]

2. Whereas **association**: a contrast between the white (**the treated**) and the grey (**the untreated**) &lt;br&gt; .blue[*"What is the risk in the treated/untreated?"*]


---
class: middle
## Association is not causation

In our example, 
- There was association because risk in the treated (= 7/13) was greater than risk in the untreated (3/7).
- There was no causation because risk if everybody treated was the same as the risk if everybody was untreated.


---
class: middle

## Association is not causation

Suppose that 5-year mortality for aspirin vs. no aspirin, 

- causal risk ratio is 0.5 
- associational risk ratio is 1.5 

This is possible because individuals at high risk of CVD death are preferentially prescribed aspirin. 
If a physician decides to withhold aspirin because those who treated had a greater risk of dying compared with untreated. This is a malpractice.


---
class: top, center, inverse
background-image: url("./fig/causalnotassociation.mp4")
background-position: 50% 50%
background-size: contain

---
class: middle, inverse, center

# Chapter 2, Randomized Experiments
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false,
"ratio": "14:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
(function(time) {
  var d2 = function(number) {
    return ('0' + number).slice(-2); // left-pad 0 to minutes/seconds
  },

  time_format = function(total) {
    var secs = Math.abs(total) / 1000;
    var h = Math.floor(secs / 3600);
    var m = Math.floor(secs % 3600 / 60);
    var s = Math.round(secs % 60);
    var res = d2(m) + ':' + d2(s);
    if (h > 0) res = h + ':' + res;
    return res;  // [hh:]mm:ss
  },

  slide_number_div = function(i) {
    return document.getElementsByClassName('remark-slide-number').item(i);
  },

  current_page_number = function(i) {
    return slide_number_div(i).firstChild.textContent;  // text "i / N"
  };

  var timer = document.createElement('span'); timer.id = 'slide-time-left';
  var time_left = time, k = slideshow.getCurrentSlideIndex(),
      last_page_number = current_page_number(k);

  setInterval(function() {
    time_left = time_left - 1000;
    timer.innerHTML = ' ' + time_format(time_left);
    if (time_left < 0) timer.style.color = 'red';
  }, 1000);

  slide_number_div(k).appendChild(timer);

  slideshow.on('showSlide', function(slide) {
    var i = slide.getSlideIndex(), n = current_page_number(i);
    // reset timer when a new slide is shown and the page number is changed
    if (last_page_number !== n) {
      time_left = time; last_page_number = n;
      timer.innerHTML = ' ' + time_format(time); timer.style.color = null;
    }
    slide_number_div(i).appendChild(timer);
  });
})(60000);
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
